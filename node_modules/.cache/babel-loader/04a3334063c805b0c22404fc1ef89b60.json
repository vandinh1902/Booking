{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\DinhNgo\\\\Desktop\\\\BookingMovie\\\\src\\\\container\\\\HomeTemplate\\\\PhongVe\\\\index.jsx\",\n    _s = $RefreshSig$();\n\nimport { Box, Grid } from \"@material-ui/core\";\nimport React, { useEffect } from \"react\";\nimport { useStyles } from \"./style\";\nimport screen from \"./../../../assets/screen.png\";\nimport ThanhTien from \"./ThanhTien/ThanhTien\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { CLEAN_UP_REDUCER_PHONG_VE, FETCH_LAY_DANH_SACH_PHONG_VE_REQUESTS_SAGA } from \"./modules/redux/constants\";\nimport Seat from \"./Seat\"; // import SeatEmpty from \"./SeatEmpty\";\n\nimport Summarize from \"./Summarize\";\nimport Swal from \"sweetalert2\";\nimport Countdown from \"../../../components/Countdown\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst PhongVe = props => {\n  _s();\n\n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const infoPhongVe = useSelector(state => state.PhongVeReducer.infoPhongVe);\n  const bookingSeat = useSelector(state => {\n    var _state$PhongVeReducer;\n\n    return (_state$PhongVeReducer = state.PhongVeReducer) === null || _state$PhongVeReducer === void 0 ? void 0 : _state$PhongVeReducer.bookingSeat;\n  });\n  let checkSeat = 1;\n  let validate = true;\n\n  if (!localStorage.getItem(\"USER\")) {\n    props.history.push(\"/\");\n  }\n\n  useEffect(() => {\n    dispatch({\n      type: FETCH_LAY_DANH_SACH_PHONG_VE_REQUESTS_SAGA,\n      payload: props.match.params.id\n    });\n    return () => {\n      dispatch({\n        type: CLEAN_UP_REDUCER_PHONG_VE\n      });\n    };\n  }, []);\n\n  const handleNoti = (icon, title) => {\n    Swal.fire({\n      icon: `${icon}`,\n      title: `${title}`\n    });\n  };\n\n  if (bookingSeat.length > 0) {\n    // trên 2 ghế thì mới kiểm tra coi có ghế ở giữa hông\n    if (bookingSeat.length > 1) {\n      let getBookingSeat = [...bookingSeat];\n      let middleStt = null;\n      getBookingSeat.sort((a, b) => parseInt(a.stt) - parseInt(b.stt));\n      getBookingSeat.map((seat1, index1) => {\n        getBookingSeat.map((seat2, index2) => {\n          if (index1 !== index2 && index1 < index2) {\n            if (parseInt(seat1.stt) + 1 === parseInt(seat2.stt) - 1) {\n              middleStt = parseInt(seat1.stt) + 1; //Kiểm tra xem ghế giữa đã có chọn chưa\n\n              if (middleStt) {\n                let index = getBookingSeat.findIndex(check => {\n                  return parseInt(check.stt) === middleStt;\n                });\n\n                if (index === -1) {\n                  handleNoti(\"warning\", \"Bạn không thể bỏ trống 1 ghế ở giữa\");\n                  validate = false;\n                  return;\n                }\n              }\n            }\n          }\n        });\n      });\n    }\n\n    bookingSeat.map((booking, index) => {\n      if ((parseInt(booking.stt) + 1) % 16 == 0) {\n        let check = parseInt(booking.stt) + 1;\n        let index = bookingSeat.findIndex((booking, index) => {\n          return parseInt(booking.stt) === check;\n        });\n\n        if (index === -1) {\n          handleNoti(\"warning\", \"Bạn không thể bỏ trống 1 ghế ở đầu mỗi dãy\");\n          validate = false;\n          return;\n        }\n      } else {\n        let firstSeatRow = 1;\n\n        for (let i = 1; i <= 11; i++) {\n          if (parseInt(booking.stt) - 1 == firstSeatRow) {\n            let check = parseInt(booking.stt) - 1;\n            let index = bookingSeat.findIndex((booking, index) => {\n              return parseInt(booking.stt) === check;\n            });\n\n            if (index === -1) {\n              handleNoti(\"warning\", \"Bạn không thể bỏ trống 1 ghế ở đầu mỗi dãy\");\n              validate = false;\n              return;\n            }\n          } else {\n            firstSeatRow += 16;\n          }\n        }\n      }\n    });\n    let bookedSeat = [...infoPhongVe.danhSachGhe].filter(booked => {\n      return booked.daDat;\n    });\n    let middleStt = null;\n    bookingSeat.map(booking => {\n      bookedSeat.map(booked => {\n        if (parseInt(booking.stt) + 1 === parseInt(booked.stt) - 1) {\n          middleStt = parseInt(booking.stt) + 1;\n          return;\n        } else if (parseInt(booking.stt) - 1 === parseInt(booked.stt) + 1) {\n          middleStt = parseInt(booking.stt) - 1;\n          return;\n        }\n      });\n    });\n    console.log(middleStt);\n\n    if (middleStt) {\n      console.log(middleStt);\n      let indexBooked = bookedSeat.findIndex(booked => {\n        return parseInt(booked.stt) === middleStt;\n      });\n      console.log(indexBooked);\n\n      if (indexBooked === -1) {\n        let indexBooking = bookingSeat.findIndex(booking => {\n          return parseInt(booking.stt) === middleStt;\n        });\n\n        if (indexBooking === -1) {\n          handleNoti(\"warning\", \"Bạn không thể bỏ trống 1 ghế ở giữa\");\n          validate = false; // return;\n        }\n      }\n    }\n  }\n\n  const renderSeat = () => {\n    return infoPhongVe === null || infoPhongVe === void 0 ? void 0 : infoPhongVe.danhSachGhe.map((ghe, index) => {\n      if ((index + 1) % 16 === 0) {\n        checkSeat = index + 2;\n        return /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(Seat, {\n            gheInfo: ghe\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true);\n      } // if (index === checkSeat) {\n      //   checkSeat += 12;\n      //   return (\n      //     <>\n      //       <Seat gheInfo={ghe} />\n      //       <SeatEmpty />\n      //     </>\n      //   );\n      // } else if (index === checkSeat) {\n      //   checkSeat += 3;\n      //   return (\n      //     <>\n      //       <Seat gheInfo={ghe} />\n      //       <SeatEmpty />\n      //     </>\n      //   );\n      // }\n\n\n      return /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: /*#__PURE__*/_jsxDEV(Seat, {\n          gheInfo: ghe\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 11\n        }, this)\n      }, void 0, false);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.bgColor,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.container,\n      children: [/*#__PURE__*/_jsxDEV(Countdown, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        container: true,\n        spacing: 0,\n        style: {\n          flexDirection: \"column\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          container: true,\n          item: true,\n          xs: 12,\n          spacing: 0,\n          style: {\n            height: \"100%\",\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\"\n          },\n          children: /*#__PURE__*/_jsxDEV(Box, {\n            style: {\n              marginTop: \"1.5rem\"\n            },\n            className: classes.overflow,\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: screen,\n              className: classes.overflow\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Box, {\n              className: classes.overflow,\n              children: /*#__PURE__*/_jsxDEV(Box, {\n                className: classes.renderSeatWrapper,\n                children: renderSeat()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 206,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 198,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          children: /*#__PURE__*/_jsxDEV(Summarize, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ThanhTien, {\n          infoPhongVe: infoPhongVe,\n          validate: validate\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 182,\n    columnNumber: 5\n  }, this);\n};\n\n_s(PhongVe, \"LVPYN4DN6+hVK92Sw2fi2qB867M=\", false, function () {\n  return [useStyles, useDispatch, useSelector, useSelector];\n});\n\n_c = PhongVe;\nexport default PhongVe;\n\nvar _c;\n\n$RefreshReg$(_c, \"PhongVe\");","map":{"version":3,"sources":["C:/Users/DinhNgo/Desktop/BookingMovie/src/container/HomeTemplate/PhongVe/index.jsx"],"names":["Box","Grid","React","useEffect","useStyles","screen","ThanhTien","useDispatch","useSelector","CLEAN_UP_REDUCER_PHONG_VE","FETCH_LAY_DANH_SACH_PHONG_VE_REQUESTS_SAGA","Seat","Summarize","Swal","Countdown","PhongVe","props","classes","dispatch","infoPhongVe","state","PhongVeReducer","bookingSeat","checkSeat","validate","localStorage","getItem","history","push","type","payload","match","params","id","handleNoti","icon","title","fire","length","getBookingSeat","middleStt","sort","a","b","parseInt","stt","map","seat1","index1","seat2","index2","index","findIndex","check","booking","firstSeatRow","i","bookedSeat","danhSachGhe","filter","booked","daDat","console","log","indexBooked","indexBooking","renderSeat","ghe","bgColor","container","flexDirection","height","display","alignItems","justifyContent","marginTop","overflow","renderSeatWrapper"],"mappings":"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","sourcesContent":["import { Box, Grid } from \"@material-ui/core\";\nimport React, { useEffect } from \"react\";\nimport { useStyles } from \"./style\";\nimport screen from \"./../../../assets/screen.png\";\nimport ThanhTien from \"./ThanhTien/ThanhTien\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport {\n  CLEAN_UP_REDUCER_PHONG_VE,\n  FETCH_LAY_DANH_SACH_PHONG_VE_REQUESTS_SAGA,\n} from \"./modules/redux/constants\";\nimport Seat from \"./Seat\";\n// import SeatEmpty from \"./SeatEmpty\";\nimport Summarize from \"./Summarize\";\nimport Swal from \"sweetalert2\";\nimport Countdown from \"../../../components/Countdown\";\n\nconst PhongVe = (props) => {\n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const infoPhongVe = useSelector((state) => state.PhongVeReducer.infoPhongVe);\n  const bookingSeat = useSelector((state) => state.PhongVeReducer?.bookingSeat);\n  let checkSeat = 1;\n  let validate = true;\n  if (!localStorage.getItem(\"USER\")) {\n    props.history.push(\"/\");\n  }\n  useEffect(() => {\n    dispatch({\n      type: FETCH_LAY_DANH_SACH_PHONG_VE_REQUESTS_SAGA,\n      payload: props.match.params.id,\n    });\n\n    return () => {\n      dispatch({\n        type: CLEAN_UP_REDUCER_PHONG_VE,\n      });\n    };\n  }, []);\n\n  const handleNoti = (icon, title) => {\n    Swal.fire({\n      icon: `${icon}`,\n      title: `${title}`,\n    });\n  };\n\n  if (bookingSeat.length > 0) {\n    // trên 2 ghế thì mới kiểm tra coi có ghế ở giữa hông\n    if (bookingSeat.length > 1) {\n      let getBookingSeat = [...bookingSeat];\n      let middleStt = null;\n      getBookingSeat.sort((a, b) => parseInt(a.stt) - parseInt(b.stt));\n      getBookingSeat.map((seat1, index1) => {\n        getBookingSeat.map((seat2, index2) => {\n          if (index1 !== index2 && index1 < index2) {\n            if (parseInt(seat1.stt) + 1 === parseInt(seat2.stt) - 1) {\n              middleStt = parseInt(seat1.stt) + 1;\n              //Kiểm tra xem ghế giữa đã có chọn chưa\n              if (middleStt) {\n                let index = getBookingSeat.findIndex((check) => {\n                  return parseInt(check.stt) === middleStt;\n                });\n                if (index === -1) {\n                  handleNoti(\"warning\", \"Bạn không thể bỏ trống 1 ghế ở giữa\");\n                  validate = false;\n                  return;\n                }\n              }\n            }\n          }\n        });\n      });\n    }\n    bookingSeat.map((booking, index) => {\n      if ((parseInt(booking.stt) + 1) % 16 == 0) {\n        let check = parseInt(booking.stt) + 1;\n        let index = bookingSeat.findIndex((booking, index) => {\n          return parseInt(booking.stt) === check;\n        });\n        if (index === -1) {\n          handleNoti(\"warning\", \"Bạn không thể bỏ trống 1 ghế ở đầu mỗi dãy\");\n          validate = false;\n          return;\n        }\n      } else {\n        let firstSeatRow = 1;\n        for (let i = 1; i <= 11; i++) {\n          if (parseInt(booking.stt) - 1 == firstSeatRow) {\n            let check = parseInt(booking.stt) - 1;\n            let index = bookingSeat.findIndex((booking, index) => {\n              return parseInt(booking.stt) === check;\n            });\n            if (index === -1) {\n              handleNoti(\n                \"warning\",\n                \"Bạn không thể bỏ trống 1 ghế ở đầu mỗi dãy\"\n              );\n              validate = false;\n              return;\n            }\n          } else {\n            firstSeatRow += 16;\n          }\n        }\n      }\n    });\n\n    let bookedSeat = [...infoPhongVe.danhSachGhe].filter((booked) => {\n      return booked.daDat;\n    });\n\n    let middleStt = null;\n\n    bookingSeat.map((booking) => {\n      bookedSeat.map((booked) => {\n        if (parseInt(booking.stt) + 1 === parseInt(booked.stt) - 1) {\n          middleStt = parseInt(booking.stt) + 1;\n          return;\n        } else if (parseInt(booking.stt) - 1 === parseInt(booked.stt) + 1) {\n          middleStt = parseInt(booking.stt) - 1;\n          return;\n        }\n      });\n    });\n    console.log(middleStt);\n    if (middleStt) {\n      console.log(middleStt);\n      let indexBooked = bookedSeat.findIndex((booked) => {\n        return parseInt(booked.stt) === middleStt;\n      });\n      console.log(indexBooked);\n      if (indexBooked === -1) {\n        let indexBooking = bookingSeat.findIndex((booking) => {\n          return parseInt(booking.stt) === middleStt;\n        });\n        if (indexBooking === -1) {\n          handleNoti(\"warning\", \"Bạn không thể bỏ trống 1 ghế ở giữa\");\n          validate = false;\n          // return;\n        }\n      }\n    }\n  }\n\n  const renderSeat = () => {\n    return infoPhongVe?.danhSachGhe.map((ghe, index) => {\n      if ((index + 1) % 16 === 0) {\n        checkSeat = index + 2;\n        return (\n          <>\n            <Seat gheInfo={ghe} />\n            <br />\n          </>\n        );\n      }\n      // if (index === checkSeat) {\n      //   checkSeat += 12;\n      //   return (\n      //     <>\n      //       <Seat gheInfo={ghe} />\n      //       <SeatEmpty />\n      //     </>\n      //   );\n      // } else if (index === checkSeat) {\n      //   checkSeat += 3;\n      //   return (\n      //     <>\n      //       <Seat gheInfo={ghe} />\n      //       <SeatEmpty />\n      //     </>\n      //   );\n      // }\n      return (\n        <>\n          <Seat gheInfo={ghe} />\n        </>\n      );\n    });\n  };\n\n  return (\n    <div className={classes.bgColor}>\n      <div className={classes.container}>\n        <Countdown />\n        <Grid container spacing={0} style={{ flexDirection: \"column\" }}>\n          <Grid\n            container\n            item\n            xs={12}\n            spacing={0}\n            style={{\n              height: \"100%\",\n              display: \"flex\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n            }}\n          >\n            <Box\n              style={{\n                marginTop: \"1.5rem\",\n              }}\n              className={classes.overflow}\n            >\n              <img src={screen} className={classes.overflow} />\n              <Box className={classes.overflow}>\n                <Box className={classes.renderSeatWrapper}>{renderSeat()}</Box>\n              </Box>\n            </Box>\n          </Grid>\n          <Box>\n            <Summarize />\n          </Box>\n          <ThanhTien infoPhongVe={infoPhongVe} validate={validate} />\n        </Grid>\n      </div>\n    </div>\n  );\n};\n\nexport default PhongVe;\n"]},"metadata":{},"sourceType":"module"}