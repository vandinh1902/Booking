{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ngova\\\\Desktop\\\\updateMovies\\\\Booking\\\\src\\\\container\\\\AdminTemplate\\\\Dashboard\\\\QuanLiMovie.jsx\",\n    _s = $RefreshSig$();\n\nimport axios from \"axios\";\nimport MaterialTable from \"material-table\";\nimport React, { useEffect, useState } from \"react\";\nimport { DOMAIN, MA_NHOM, STATUS_CODE } from \"../../../utils/common/constants\";\nimport \"date-fns\";\nimport DateFnsUtils from \"@date-io/date-fns\";\nimport { MuiPickersUtilsProvider, KeyboardTimePicker, KeyboardDatePicker } from \"@material-ui/pickers\";\nimport Swal from \"sweetalert2\";\nimport { CardMedia, TextField } from \"@material-ui/core\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst QuanLiMovie = () => {\n  _s();\n\n  const [selectedDate, setSelectedDate] = useState(new Date(\"2014-08-18T21:11:54\"));\n  const {\n    maNhom,\n    maLoaiNguoiDung,\n    accessToken\n  } = JSON.parse(localStorage.getItem(\"ADMIN\"));\n  const [columns, setColumns] = useState([{\n    title: \"Mã phim\",\n    field: \"maPhim\",\n    type: \"numeric\",\n    editable: \"onAdd\"\n  }, {\n    title: \"Tên phim\",\n    field: \"tenPhim\"\n  }, {\n    title: \"Bí danh\",\n    field: \"biDanh\"\n  }, {\n    title: \"Trailer\",\n    field: \"trailer\",\n    render: props => /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"[Chi ti\\u1EBFt]\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 37,\n      columnNumber: 26\n    }, this)\n  }, {\n    title: \"Hình ảnh\",\n    field: \"hinhAnh\",\n    editComponent: props => /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"file\",\n      onChange: e => props.onChange(e.target.files[0])\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 9\n    }, this),\n    render: rowData => /*#__PURE__*/_jsxDEV(\"img\", {\n      src: rowData.hinhAnh,\n      style: {\n        width: 75,\n        borderRadius: \"4px\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 9\n    }, this)\n  }, {\n    title: \"Mô tả\",\n    field: \"moTa\",\n    render: rowData => /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: \"100%\",\n        minWidth: \"350px\",\n        textAlign: \"justify\"\n      },\n      children: rowData.moTa\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 9\n    }, this)\n  }, {\n    title: \"Ngày khởi chiếu\",\n    field: \"ngayKhoiChieu\",\n    dateSetting: {\n      locale: \"en-GB\"\n    },\n    editComponent: props => /*#__PURE__*/_jsxDEV(MuiPickersUtilsProvider, {\n      utils: DateFnsUtils,\n      children: /*#__PURE__*/_jsxDEV(KeyboardDatePicker, {\n        style: {\n          minWidth: \"125px\"\n        },\n        disableToolbar: true,\n        variant: \"inline\",\n        format: \"MM/dd/yyyy\",\n        margin: \"normal\",\n        id: \"date-picker-inline\",\n        label: \"Date picker inline\" // value={selectedDate}\n        // onChange={handleDateChange}\n        ,\n        value: props.value ? props.value : new Date().toLocaleDateString(),\n        onChange: date => {\n          props.onChange(date);\n        },\n        KeyboardButtonProps: {\n          \"aria-label\": \"change date\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 9\n    }, this),\n    render: rowData => /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: \"100%\",\n        width: \"100px\",\n        textAlign: \"justify\"\n      },\n      children: new Date(rowData.ngayKhoiChieu).toLocaleDateString(\"en-GB\", {\n        year: \"numeric\",\n        month: \"2-digit\",\n        day: \"2-digit\"\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }, this)\n  }, {\n    title: \"Đánh giá\",\n    field: \"danhGia\",\n    type: \"numeric\"\n  }]);\n  const [data, setData] = useState([]);\n  const adminInfo = JSON.parse(localStorage.getItem(\"ADMIN\"));\n  useEffect(() => {\n    handleFetchData();\n  }, []);\n\n  const handleNoti = (icon, title, text) => {\n    Swal.fire({\n      icon: `${icon}`,\n      title: `${title}`,\n      text: `${text}`\n    });\n  };\n\n  const handleFetchData = () => {\n    axios({\n      method: \"GET\",\n      url: `${DOMAIN}/QuanLyPhim/LayDanhSachPhim?maNhom=${MA_NHOM}`\n    }).then(res => {\n      setData(res.data);\n    }).catch(err => {\n      console.log(err.response);\n    });\n  };\n\n  const handleDeleteMovie = async maPhim => {\n    try {\n      const result = await axios({\n        url: `${DOMAIN}/QuanLyPhim/XoaPhim?MaPhim=${maPhim}`,\n        method: \"DELETE\",\n        headers: {\n          Authorization: `Bearer ${adminInfo.accessToken}`\n        }\n      });\n\n      if (result.status === STATUS_CODE.SUCCESS) {\n        handleNoti(\"success\", \"Xoá thành công\", \"\");\n        handleFetchData();\n      }\n    } catch (err) {\n      handleNoti(\"error\", \"Xoá thất bại\", `${err.response.data}`);\n    }\n  };\n\n  const handleAddMovie = async infoMovie => {\n    var _infoMovie$ngayKhoiCh;\n\n    let frm = new FormData();\n    let danhGia = parseInt(infoMovie.danhGia);\n    let maPhim = parseInt(infoMovie.maPhim);\n    let ngayKhoiChieu = (_infoMovie$ngayKhoiCh = infoMovie.ngayKhoiChieu) === null || _infoMovie$ngayKhoiCh === void 0 ? void 0 : _infoMovie$ngayKhoiCh.toLocaleDateString(\"en-GB\", {\n      year: \"numeric\",\n      month: \"2-digit\",\n      day: \"2-digit\"\n    });\n    const infoMovieSend = { ...infoMovie,\n      danhGia,\n      maPhim,\n      maNhom: \"GP09\",\n      ngayKhoiChieu\n    };\n\n    for (let key in infoMovieSend) {\n      frm.append(key, infoMovieSend[key]);\n    }\n\n    try {\n      const result = await axios({\n        url: `${DOMAIN}/QuanLyPhim/ThemPhimUploadHinh`,\n        method: \"POST\",\n        data: frm\n      });\n\n      if (result.status === STATUS_CODE.SUCCESS) {\n        handleNoti(\"success\", \"Thêm phim thành công\", \"\");\n        handleFetchData();\n      }\n    } catch (err) {\n      handleNoti(\"error\", \"Thêm phim thất bại\", `${err.response.data}`);\n    }\n  };\n\n  const handleEditMovie = async infoMovie => {\n    let frm = new FormData();\n    let danhGia = parseInt(infoMovie.danhGia);\n    let maPhim = parseInt(infoMovie.maPhim);\n    let ngayKhoiChieu = new Date(infoMovie.ngayKhoiChieu).toLocaleDateString(\"en-GB\", {\n      year: \"numeric\",\n      month: \"2-digit\",\n      day: \"2-digit\"\n    });\n    const infoMovieSend = { ...infoMovie,\n      danhGia,\n      maPhim,\n      maNhom: \"GP09\",\n      ngayKhoiChieu\n    };\n\n    for (let key in infoMovieSend) {\n      frm.append(key, infoMovieSend[key]);\n    }\n\n    try {\n      const result = await axios({\n        url: `${DOMAIN}/QuanLyPhim/CapNhatPhimUpload`,\n        method: \"POST\",\n        data: frm,\n        headers: {\n          Authorization: `Bearer ${accessToken}`\n        }\n      });\n\n      if (result.status === STATUS_CODE.SUCCESS) {\n        handleNoti(\"success\", \"Cập nhật phim thành công\", \"\");\n        handleFetchData();\n      }\n    } catch (err) {\n      handleNoti(\"error\", \"Cập nhật phim thất bại\", `${err.response.data}`);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(MaterialTable, {\n      title: \"Qu\\u1EA3n l\\xED phim\",\n      columns: columns,\n      data: data,\n      editable: {\n        onRowAdd: newData => new Promise((resolve, reject) => {\n          handleAddMovie(newData);\n          resolve();\n        }, 1000),\n        onRowUpdate: (newData, oldData) => new Promise((resolve, reject) => {\n          setTimeout(() => {\n            handleEditMovie(newData);\n            resolve();\n          }, 1000);\n        }),\n        onRowDelete: oldData => new Promise((resolve, reject) => {\n          setTimeout(() => {\n            handleDeleteMovie(oldData.maPhim);\n            resolve();\n          }, 1000);\n        })\n      },\n      options: {\n        tableLayout: \"auto\"\n      },\n      detailPanel: rowData => {\n        return /*#__PURE__*/_jsxDEV(\"iframe\", {\n          width: \"80%\",\n          height: \"500px\",\n          src: `${rowData.trailer}`,\n          frameborder: \"0\",\n          allow: \"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\",\n          allowFullScreen: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 13\n        }, this);\n      },\n      onRowClick: (event, rowData, togglePanel) => togglePanel()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 228,\n    columnNumber: 5\n  }, this);\n};\n\n_s(QuanLiMovie, \"uqwvFBC7FHoh5jgUDUsg6zy3+30=\");\n\n_c = QuanLiMovie;\nexport default QuanLiMovie;\n\nvar _c;\n\n$RefreshReg$(_c, \"QuanLiMovie\");","map":{"version":3,"sources":["C:/Users/ngova/Desktop/updateMovies/Booking/src/container/AdminTemplate/Dashboard/QuanLiMovie.jsx"],"names":["axios","MaterialTable","React","useEffect","useState","DOMAIN","MA_NHOM","STATUS_CODE","DateFnsUtils","MuiPickersUtilsProvider","KeyboardTimePicker","KeyboardDatePicker","Swal","CardMedia","TextField","QuanLiMovie","selectedDate","setSelectedDate","Date","maNhom","maLoaiNguoiDung","accessToken","JSON","parse","localStorage","getItem","columns","setColumns","title","field","type","editable","render","props","editComponent","e","onChange","target","files","rowData","hinhAnh","width","borderRadius","minWidth","textAlign","moTa","dateSetting","locale","value","toLocaleDateString","date","ngayKhoiChieu","year","month","day","data","setData","adminInfo","handleFetchData","handleNoti","icon","text","fire","method","url","then","res","catch","err","console","log","response","handleDeleteMovie","maPhim","result","headers","Authorization","status","SUCCESS","handleAddMovie","infoMovie","frm","FormData","danhGia","parseInt","infoMovieSend","key","append","handleEditMovie","onRowAdd","newData","Promise","resolve","reject","onRowUpdate","oldData","setTimeout","onRowDelete","tableLayout","trailer","event","togglePanel"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport MaterialTable from \"material-table\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { DOMAIN, MA_NHOM, STATUS_CODE } from \"../../../utils/common/constants\";\r\nimport \"date-fns\";\r\nimport DateFnsUtils from \"@date-io/date-fns\";\r\nimport {\r\n  MuiPickersUtilsProvider,\r\n  KeyboardTimePicker,\r\n  KeyboardDatePicker,\r\n} from \"@material-ui/pickers\";\r\nimport Swal from \"sweetalert2\";\r\nimport { CardMedia, TextField } from \"@material-ui/core\";\r\n\r\nconst QuanLiMovie = () => {\r\n  const [selectedDate, setSelectedDate] = useState(\r\n    new Date(\"2014-08-18T21:11:54\")\r\n  );\r\n  const { maNhom, maLoaiNguoiDung, accessToken } = JSON.parse(\r\n    localStorage.getItem(\"ADMIN\")\r\n  );\r\n  const [columns, setColumns] = useState([\r\n    {\r\n      title: \"Mã phim\",\r\n      field: \"maPhim\",\r\n      type: \"numeric\",\r\n      editable: \"onAdd\",\r\n    },\r\n    {\r\n      title: \"Tên phim\",\r\n      field: \"tenPhim\",\r\n    },\r\n    { title: \"Bí danh\", field: \"biDanh\" },\r\n    {\r\n      title: \"Trailer\",\r\n      field: \"trailer\",\r\n      render: (props) => <div>[Chi tiết]</div>,\r\n    },\r\n    {\r\n      title: \"Hình ảnh\",\r\n      field: \"hinhAnh\",\r\n      editComponent: (props) => (\r\n        <input\r\n          type=\"file\"\r\n          onChange={(e) => props.onChange(e.target.files[0])}\r\n        />\r\n      ),\r\n      render: (rowData) => (\r\n        <img src={rowData.hinhAnh} style={{ width: 75, borderRadius: \"4px\" }} />\r\n      ),\r\n    },\r\n    {\r\n      title: \"Mô tả\",\r\n      field: \"moTa\",\r\n      render: (rowData) => (\r\n        <div style={{ width: \"100%\", minWidth: \"350px\", textAlign: \"justify\" }}>\r\n          {rowData.moTa}\r\n        </div>\r\n      ),\r\n    },\r\n    {\r\n      title: \"Ngày khởi chiếu\",\r\n      field: \"ngayKhoiChieu\",\r\n      dateSetting: { locale: \"en-GB\" },\r\n      editComponent: (props) => (\r\n        <MuiPickersUtilsProvider utils={DateFnsUtils}>\r\n          <KeyboardDatePicker\r\n            style={{ minWidth: \"125px\" }}\r\n            disableToolbar\r\n            variant=\"inline\"\r\n            format=\"MM/dd/yyyy\"\r\n            margin=\"normal\"\r\n            id=\"date-picker-inline\"\r\n            label=\"Date picker inline\"\r\n            // value={selectedDate}\r\n            // onChange={handleDateChange}\r\n            value={props.value ? props.value : new Date().toLocaleDateString()}\r\n            onChange={(date) => {\r\n              props.onChange(date);\r\n            }}\r\n            KeyboardButtonProps={{\r\n              \"aria-label\": \"change date\",\r\n            }}\r\n          />\r\n        </MuiPickersUtilsProvider>\r\n      ),\r\n      render: (rowData) => (\r\n        <div style={{ width: \"100%\", width: \"100px\", textAlign: \"justify\" }}>\r\n          {new Date(rowData.ngayKhoiChieu).toLocaleDateString(\"en-GB\", {\r\n            year: \"numeric\",\r\n            month: \"2-digit\",\r\n            day: \"2-digit\",\r\n          })}\r\n        </div>\r\n      ),\r\n    },\r\n    {\r\n      title: \"Đánh giá\",\r\n      field: \"danhGia\",\r\n      type: \"numeric\",\r\n    },\r\n  ]);\r\n\r\n  const [data, setData] = useState([]);\r\n  const adminInfo = JSON.parse(localStorage.getItem(\"ADMIN\"));\r\n\r\n  useEffect(() => {\r\n    handleFetchData();\r\n  }, []);\r\n\r\n  const handleNoti = (icon, title, text) => {\r\n    Swal.fire({\r\n      icon: `${icon}`,\r\n      title: `${title}`,\r\n      text: `${text}`,\r\n    });\r\n  };\r\n\r\n  const handleFetchData = () => {\r\n    axios({\r\n      method: \"GET\",\r\n      url: `${DOMAIN}/QuanLyPhim/LayDanhSachPhim?maNhom=${MA_NHOM}`,\r\n    })\r\n      .then((res) => {\r\n        setData(res.data);\r\n      })\r\n      .catch((err) => {\r\n        console.log(err.response);\r\n      });\r\n  };\r\n\r\n  const handleDeleteMovie = async (maPhim) => {\r\n    try {\r\n      const result = await axios({\r\n        url: `${DOMAIN}/QuanLyPhim/XoaPhim?MaPhim=${maPhim}`,\r\n        method: \"DELETE\",\r\n        headers: {\r\n          Authorization: `Bearer ${adminInfo.accessToken}`,\r\n        },\r\n      });\r\n      if (result.status === STATUS_CODE.SUCCESS) {\r\n        handleNoti(\"success\", \"Xoá thành công\", \"\");\r\n        handleFetchData();\r\n      }\r\n    } catch (err) {\r\n      handleNoti(\"error\", \"Xoá thất bại\", `${err.response.data}`);\r\n    }\r\n  };\r\n\r\n  const handleAddMovie = async (infoMovie) => {\r\n    let frm = new FormData();\r\n    let danhGia = parseInt(infoMovie.danhGia);\r\n    let maPhim = parseInt(infoMovie.maPhim);\r\n    let ngayKhoiChieu = infoMovie.ngayKhoiChieu?.toLocaleDateString(\"en-GB\", {\r\n      year: \"numeric\",\r\n      month: \"2-digit\",\r\n      day: \"2-digit\",\r\n    });\r\n    const infoMovieSend = {\r\n      ...infoMovie,\r\n      danhGia,\r\n      maPhim,\r\n      maNhom: \"GP09\",\r\n      ngayKhoiChieu,\r\n    };\r\n    for (let key in infoMovieSend) {\r\n      frm.append(key, infoMovieSend[key]);\r\n    }\r\n\r\n    try {\r\n      const result = await axios({\r\n        url: `${DOMAIN}/QuanLyPhim/ThemPhimUploadHinh`,\r\n        method: \"POST\",\r\n        data: frm,\r\n      });\r\n\r\n      if (result.status === STATUS_CODE.SUCCESS) {\r\n        handleNoti(\"success\", \"Thêm phim thành công\", \"\");\r\n        handleFetchData();\r\n      }\r\n    } catch (err) {\r\n      handleNoti(\"error\", \"Thêm phim thất bại\", `${err.response.data}`);\r\n    }\r\n  };\r\n\r\n  const handleEditMovie = async (infoMovie) => {\r\n    let frm = new FormData();\r\n    let danhGia = parseInt(infoMovie.danhGia);\r\n    let maPhim = parseInt(infoMovie.maPhim);\r\n    let ngayKhoiChieu = new Date(infoMovie.ngayKhoiChieu).toLocaleDateString(\r\n      \"en-GB\",\r\n      {\r\n        year: \"numeric\",\r\n        month: \"2-digit\",\r\n        day: \"2-digit\",\r\n      }\r\n    );\r\n    const infoMovieSend = {\r\n      ...infoMovie,\r\n      danhGia,\r\n      maPhim,\r\n      maNhom: \"GP09\",\r\n      ngayKhoiChieu,\r\n    };\r\n    for (let key in infoMovieSend) {\r\n      frm.append(key, infoMovieSend[key]);\r\n    }\r\n\r\n    try {\r\n      const result = await axios({\r\n        url: `${DOMAIN}/QuanLyPhim/CapNhatPhimUpload`,\r\n        method: \"POST\",\r\n        data: frm,\r\n        headers: {\r\n          Authorization: `Bearer ${accessToken}`,\r\n        },\r\n      });\r\n      if (result.status === STATUS_CODE.SUCCESS) {\r\n        handleNoti(\"success\", \"Cập nhật phim thành công\", \"\");\r\n        handleFetchData();\r\n      }\r\n    } catch (err) {\r\n      handleNoti(\"error\", \"Cập nhật phim thất bại\", `${err.response.data}`);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <MaterialTable\r\n        title=\"Quản lí phim\"\r\n        columns={columns}\r\n        data={data}\r\n        editable={{\r\n          onRowAdd: (newData) =>\r\n            new Promise((resolve, reject) => {\r\n              handleAddMovie(newData);\r\n              resolve();\r\n            }, 1000),\r\n          onRowUpdate: (newData, oldData) =>\r\n            new Promise((resolve, reject) => {\r\n              setTimeout(() => {\r\n                handleEditMovie(newData);\r\n                resolve();\r\n              }, 1000);\r\n            }),\r\n          onRowDelete: (oldData) =>\r\n            new Promise((resolve, reject) => {\r\n              setTimeout(() => {\r\n                handleDeleteMovie(oldData.maPhim);\r\n                resolve();\r\n              }, 1000);\r\n            }),\r\n        }}\r\n        options={{\r\n          tableLayout: \"auto\",\r\n        }}\r\n        detailPanel={(rowData) => {\r\n          return (\r\n            <iframe\r\n              width=\"80%\"\r\n              height=\"500px\"\r\n              src={`${rowData.trailer}`}\r\n              frameborder=\"0\"\r\n              allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\"\r\n              allowFullScreen\r\n            />\r\n          );\r\n        }}\r\n        onRowClick={(event, rowData, togglePanel) => togglePanel()}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default QuanLiMovie;\r\n"]},"metadata":{},"sourceType":"module"}